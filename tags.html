---
layout: default
title: "Tags"
---

{% assign all_docs = site.posts | concat: site.work %}
{% assign all_tags = all_docs | map: "tags" | join: "," | split: "," | uniq %}

<h2>Browse by Tags</h2>

<div>
  <button id="sortByCount" class="sort-button">Sort by Count (Descending)</button>
  <button id="sortByAlpha" class="sort-button">Sort Alphabetically</button>
</div>

<div id="tagsGrid" class="tags-grid">
  {% assign tags_with_count = '' | split: '' %}
  {% for tag in all_tags %}
    {% assign tag_count = 0 %}
    {% for doc in all_docs %}
      {% if doc.tags contains tag %}
        {% assign tag_count = tag_count | plus: 1 %}
      {% endif %}
    {% endfor %}
    {% assign padded_count = tag_count | prepend: '0000' | slice: -4,4 %}
    {% assign entry = padded_count | append: '|' | append: tag_count | append: '|' | append: tag %}
    {% assign tags_with_count = tags_with_count | push: entry %}
  {% endfor %}
  {% assign sorted_entries = tags_with_count | sort | reverse %}
  {% for entry in sorted_entries %}
    {% assign parts = entry | split: '|' %}
    {% assign tag = parts[2] %}
    {% assign tag_count = parts[1] %}
    <div class="tag-cell" data-tag="{{ tag | slugify }}" data-count="{{ tag_count }}">
      <a href="#{{ tag | slugify }}">{{ tag }}</a> ({{ tag_count }})
    </div>
  {% endfor %}
</div>

<script>
  // Ascending
  // Store tags data for sorting
  const tagsData = [
    {% for entry in sorted_entries %}
      {% assign parts = entry | split: '|' %}
      {% assign tag = parts[2] %}
      {% assign tag_count = parts[1] %}
      { tag: "{{ tag }}", count: {{ tag_count }}, slug: "{{ tag | slugify }}" },
    {% endfor %}
  ];

  const tagsGrid = document.getElementById('tagsGrid');
  const sortByCountButton = document.getElementById('sortByCount');
  const sortByAlphaButton = document.getElementById('sortByAlpha');

  function renderGrid(data) {
    tagsGrid.innerHTML = '';
    data.forEach(item => {
      const cell = document.createElement('div');
      cell.className = 'tag-cell';
      cell.dataset.tag = item.slug;
      cell.dataset.count = item.count;
      cell.innerHTML = `<a href="#${item.slug}">${item.tag}</a> (${item.count})`;
      tagsGrid.appendChild(cell);
    });
  }

  sortByCountButton.addEventListener('click', () => {
    const sorted = [...tagsData].sort((a, b) => b.count - a.count);
    renderGrid(sorted);
    sortByCountButton.disabled = true;
    sortByAlphaButton.disabled = false;
  });

  sortByAlphaButton.addEventListener('click', () => {
    const sorted = [...tagsData].sort((a, b) => a.tag.localeCompare(b.tag));
    renderGrid(sorted);
    sortByCountButton.disabled = false;
    sortByAlphaButton.disabled = true;
  });

  // Initial state: sort by count
  sortByCountButton.disabled = true;
</script>

<style>
  .sort-button {
    padding: 8px 16px;
    margin-right: 8px;
    margin-bottom: 1em;
    cursor: pointer;
    background-color: #f0f0f0;
    border: 1px solid #ddd;
    border-radius: 4px;
    transition: background-color 0.2s;
  }
  .sort-button:disabled {
    background-color: #d0d0d0;
    cursor: not-allowed;
  }
  .sort-button:hover:not(:disabled) {
    background-color: #e0e0e0;
  }
  .tags-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 10px;
    padding: 10px 0;
  }
  .tag-cell {
    background-color: #f9f9f9;
    padding: 10px;
    border-radius: 6px;
    text-align: center;
    border: 1px solid #eee;
    transition: transform 0.2s, box-shadow 0.2s;
  }
  .tag-cell:hover {
    transform: translateY(-2px);
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }
  .tag-cell a {
    text-decoration: none;
    color: #2c3e50;
    font-weight: 500;
  }
  .tag-cell a:hover {
    color: #2980b9;
  }
</style>

{% assign all_tags = all_tags | sort %}
{% for tag in all_tags %}
  <h3 id="{{ tag | slugify }}">{{ tag }}</h3>
  <ul>
    {% for doc in all_docs %}
      {% if doc.tags contains tag %}
        <li>
          <a href="{{ doc.url }}">{{ doc.title }}</a>
          {% if doc.collection %}
            ({{ doc.collection }})
          {% endif %}
        </li>
      {% endif %}
    {% endfor %}
  </ul>
{% endfor %}